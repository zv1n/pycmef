<html>
  <head>
    <script src='../cmef/cmef.js' type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="../cmef/pure.css">
    <link rel="stylesheet" type="text/css" href="../cmef/cmef.css">
    <link rel="stylesheet" type="text/css" href="../experiment.css">
    <title></title>
    <script>
      cmef.ready(function() {
        $("[name='']").on('click', function() {
          $('').removeClass('pure-button-disabled').attr('disabled', false);
        });

        var show_grid = function (show) {
          if (show) {
            $('#grid').show();
            $('#study').hide();
            $('.close-button').hide();
          } else {
            $('#grid').hide();
            $('#study').show();
            $('.close-button').show();
          }
        };

        var end_study = function () {
          show_grid(true);
          $('#grid').hide();
          show_timer(false);
          show_next_button(true);
        };

        var show_timer = function (show) {
          if (show)
            $('.timer-container').show();
          else
            $('.timer-container').hide();
        };

        var show_next_buttons = function (show) {
          if (show)
            $('#next-footer').show();
          else
            $('#next-footer').hide();
        };

        // Take 2 input values and generate our div.
        var gen_divs = function (value1, value2) {
          var middle = $('<div>').addClass('middle').html(value1);
          var selection = $('<div>').addClass('selection').html(middle);

          selection.data('first', value);
          selection.data('second', value2);

          return $('<div>').addClass('pure-u-1-5').html(selection);
        }

        var timer_started = false;

        // Iterate over the data grid and inject our generated divs.
        var grid = new DataGrid('.pure-g.datagrid', 5, 6, function (data) {
          return gen_divs(data.first, data.first);
        });

        $('.selection').on('click', function(event) {
          show_grid(false);
          $(event.currentTarget).addClass('previously-selected');

          var first = $(this).data('first');
          $('#study #first').html(first);

          var second = $(this).data('second');
          $('#study #second').html(second);

          if (!timer_started) {
            cmef.timer('study-end', end_study);
            timer_started = true;
          }
        });

        $('.close-button').on('click', function(event) {
          show_grid(true);
        });

        // Initialize the view to show the primary Grid.
        show_grid(true);
      });
    </script>
  </head>
  <body>
    <div id="study">
      <div class="pure-g text-middle">
        <div class="pure-u-1-5"></div>
        <div class="pure-u-1-5 text-center" id="first">first</div>
        <div class="pure-u-1-5"></div>
        <div class="pure-u-1-5 text-center" id="second">second</div>
        <div class="pure-u-1-5"></div>
      </div>
    </div>
    <div id="grid" style="display: none;" class="text-middle">
      <div class="pure-g datagrid"></div>
      <footer class="cmef-buttons">
      </footer>
    </div>
    <footer class="cmef-buttons timer-container">
      <div class="timer" id="study-end"></div>
      <input type="button" id="close" value="Close" class="pure-button close-button">
    </footer>
    <footer class="cmef-buttons" id="next-footer">
      <input type="button" id="next" value="Continue" class="pure-button" data-default="true">
    </footer>
  </body>

</html>
